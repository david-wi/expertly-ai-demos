<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Concierge Reservation Intake</title>
<style>
:root{
--bg: #f5f6f8;
--panel: #ffffff;
--text: #1f2937;
--muted: #6b7280;
--border: #e5e7eb;
--shadow: 0 8px 30px rgba(15, 23, 42, 0.08);
--accent: #7b6a5e;
--accent-2: #111827;
--ok: #065f46;
--warn: #92400e;
--danger: #991b1b;
--focus: 0 0 0 3px rgba(123, 106, 94, 0.25);
--radius: 12px;
--radius-sm: 10px;
--font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
}
*{ box-sizing: border-box; }
html, body { height: 100%; }
body{
margin: 0;
font-family: var(--font);
background: radial-gradient(1200px 800px at 15% 10%, #ffffff 0%, var(--bg) 45%, #eef1f6 100%);
color: var(--text);
}
.topbar{
position: sticky;
top: 0;
z-index: 20;
backdrop-filter: blur(10px);
background: rgba(245, 246, 248, 0.78);
border-bottom: 1px solid var(--border);
}
.topbar-inner{
max-width: 1200px;
margin: 0 auto;
padding: 14px 18px;
display: flex;
align-items: center;
justify-content: space-between;
gap: 12px;
}
.brand{
display:flex;
align-items:center;
gap: 10px;
min-width: 260px;
}
.mark{
width: 34px;
height: 34px;
border-radius: 10px;
background: linear-gradient(135deg, var(--accent) 0%, #b59a86 100%);
box-shadow: 0 10px 18px rgba(123, 106, 94, 0.18);
}
.titlewrap{ line-height: 1.15; }
.title{ font-weight: 700; letter-spacing: -0.01em; }
.subtitle{ font-size: 12px; color: var(--muted); }
.badges{ display:flex; gap: 8px; flex-wrap: wrap; align-items:center; justify-content:flex-end; }
.badge{
font-size: 12px;
padding: 6px 10px;
border: 1px solid var(--border);
border-radius: 999px;
background: rgba(255,255,255,0.7);
color: var(--muted);
white-space: nowrap;
}
.badge.strong{
border-color: rgba(123,106,94,0.35);
color: #5a4b41;
background: rgba(123,106,94,0.10);
}
main{
max-width: 700px;
margin: 0 auto;
padding: 18px;
}
@media (max-width: 980px){
.brand{ min-width: unset; }
}
.panel{
background: var(--panel);
border: 1px solid var(--border);
border-radius: var(--radius);
box-shadow: var(--shadow);
overflow: hidden;
}
.panel-header{
padding: 14px 16px;
border-bottom: 1px solid var(--border);
display:flex;
align-items:flex-start;
justify-content: space-between;
gap: 12px;
background: linear-gradient(180deg, #ffffff 0%, #fbfbfd 100%);
}
.panel-header h2{
font-size: 14px;
margin: 0;
letter-spacing: 0.02em;
text-transform: uppercase;
color: #374151;
}
.panel-header p{
margin: 6px 0 0;
font-size: 13px;
color: var(--muted);
line-height: 1.4;
}
.panel-body{ padding: 14px 16px 16px; }
.btnrow{ display:flex; gap: 10px; flex-wrap: wrap; justify-content:flex-end; }
button{
font-family: inherit;
border-radius: 10px;
border: 1px solid var(--border);
background: #ffffff;
color: var(--text);
padding: 10px 12px;
font-weight: 600;
cursor: pointer;
transition: transform 0.04s ease, box-shadow 0.15s ease, border-color 0.15s ease, background 0.15s ease;
}
button:hover{ border-color: #d1d5db; }
button:active{ transform: translateY(1px); }
button.primary{
background: var(--accent);
border-color: rgba(0,0,0,0.0);
color: #fff;
}
button.primary:hover{ filter: brightness(0.98); }
button.danger{
background: #fff;
border-color: rgba(153, 27, 27, 0.25);
color: var(--danger);
}
button.ghost{ background: transparent; }
button.small{
padding: 8px 10px;
font-size: 12px;
border-radius: 9px;
}
label{
display:block;
font-size: 12px;
color: var(--muted);
margin-bottom: 6px;
}
input, select, textarea{
width: 100%;
padding: 10px 10px;
border-radius: 10px;
border: 1px solid var(--border);
outline: none;
font-family: inherit;
font-size: 14px;
background: #fff;
}
input:focus, select:focus, textarea:focus{
box-shadow: var(--focus);
border-color: rgba(123, 106, 94, 0.55);
}
textarea{ min-height: 130px; resize: vertical; }
.grid2{ display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.grid3{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }
@media (max-width: 520px){ .grid2, .grid3{ grid-template-columns: 1fr; } }
.hint{
font-size: 12px;
color: var(--muted);
margin-top: 10px;
line-height: 1.4;
}
.mono{
font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
font-size: 12px;
}
pre{
margin: 10px 0 0;
background: #0b1020;
color: #dbeafe;
padding: 12px;
border-radius: 12px;
overflow:auto;
border: 1px solid rgba(255,255,255,0.08);
}
.phone-wrap{
display:flex;
justify-content:center;
padding: 18px 10px 22px;
background: linear-gradient(180deg, #ffffff 0%, #fafafa 100%);
}
.phone{
width: 420px;
max-width: 100%;
border-radius: 20px;
border: 1px solid #d6d7db;
box-shadow: 0 24px 60px rgba(0,0,0,0.12);
background: #fff;
overflow: hidden;
}
.phone-top{
background: var(--accent);
color: #f9fafb;
padding: 12px 14px;
display:flex;
align-items:center;
gap: 10px;
font-weight: 700;
}
.back{
width: 30px;
height: 30px;
display:grid;
place-items:center;
border-radius: 10px;
background: rgba(255,255,255,0.10);
border: 1px solid rgba(255,255,255,0.15);
cursor: pointer;
user-select:none;
}
.phone-top .meta{
font-weight: 650;
font-size: 13px;
letter-spacing: 0.01em;
opacity: 0.95;
}
.notice{
padding: 10px 14px;
font-size: 12px;
color: #374151;
background: #f3f4f6;
border-bottom: 1px solid var(--border);
display:flex;
align-items:center;
justify-content: space-between;
gap: 10px;
}
.notice strong{ font-weight: 800; }
.notice .pill{
font-size: 12px;
padding: 4px 10px;
border-radius: 999px;
border: 1px solid rgba(0,0,0,0.06);
background: rgba(255,255,255,0.6);
color: var(--muted);
white-space: nowrap;
}
.notice.ok{
background: #ecfdf5;
color: #064e3b;
}
.notice.ok .pill{
color: #065f46;
border-color: rgba(6, 95, 70, 0.18);
}
.notice.warn{
background: #fffbeb;
color: #78350f;
}
.notice.warn .pill{
color: #92400e;
border-color: rgba(146, 64, 14, 0.18);
}
.card{ padding: 12px 14px 14px; }
.section-title{
margin: 10px 0 10px;
text-align:center;
font-weight: 800;
color: #374151;
letter-spacing: -0.01em;
}
.subcard{
border: 1px solid var(--border);
border-radius: 14px;
overflow:hidden;
background: #fff;
box-shadow: 0 16px 26px rgba(15,23,42,0.06);
}
.subcard .row{
padding: 10px 12px;
border-top: 1px solid var(--border);
}
.subcard .row:first-child{ border-top: 0; }
.subcard .row.head{
background: #f9fafb;
font-weight: 800;
color: #374151;
font-size: 13px;
}
.row-grid2{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.row-grid3{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
@media (max-width: 420px){ .row-grid2, .row-grid3{ grid-template-columns: 1fr; } }
.inline{
display:flex;
align-items:center;
justify-content: space-between;
gap: 10px;
}
.addbtn{
border: 1px solid var(--border);
background: #fff;
border-radius: 10px;
padding: 7px 10px;
font-size: 12px;
font-weight: 800;
cursor:pointer;
}
.chips{
display:flex;
gap: 8px;
flex-wrap: wrap;
margin-top: 8px;
}
.chip{
display:inline-flex;
align-items:center;
gap: 8px;
padding: 6px 10px;
border-radius: 999px;
background: rgba(123, 106, 94, 0.12);
border: 1px solid rgba(123, 106, 94, 0.22);
color: #5a4b41;
font-size: 12px;
font-weight: 750;
}
.chip button{
padding: 0;
width: 18px;
height: 18px;
border-radius: 6px;
border: 1px solid rgba(0,0,0,0.08);
background: rgba(255,255,255,0.7);
color: #5a4b41;
font-weight: 900;
line-height: 1;
cursor: pointer;
}
.footer-actions{
padding: 12px 14px 16px;
border-top: 1px solid var(--border);
display:flex;
flex-direction: column;
gap: 10px;
}
.checkrow{
display:flex;
gap: 10px;
align-items:flex-start;
font-size: 12px;
color: #4b5563;
}
.checkrow input[type="checkbox"]{
width: 16px;
height: 16px;
margin-top: 2px;
}
.cta{
width: 100%;
padding: 12px 12px;
border-radius: 12px;
background: var(--accent);
color: #fff;
border: 0;
font-size: 14px;
font-weight: 850;
}
.modal-backdrop{
position: fixed;
inset: 0;
background: rgba(15, 23, 42, 0.55);
display:none;
align-items:center;
justify-content:center;
padding: 18px;
z-index: 50;
}
.modal{
width: 520px;
max-width: 100%;
background: #fff;
border-radius: 16px;
border: 1px solid rgba(255,255,255,0.08);
box-shadow: 0 30px 80px rgba(0,0,0,0.25);
overflow:hidden;
}
.modal-head{
padding: 14px 16px;
display:flex;
align-items:center;
justify-content: space-between;
gap: 10px;
border-bottom: 1px solid var(--border);
background: linear-gradient(180deg, #ffffff 0%, #fbfbfd 100%);
}
.modal-head strong{ font-size: 14px; }
.modal-body{ padding: 14px 16px; }
.modal-foot{
padding: 14px 16px;
border-top: 1px solid var(--border);
display:flex;
justify-content:flex-end;
gap: 10px;
background: #fff;
}
.tiny-toggle{
display:flex;
gap: 8px;
align-items:center;
font-size: 12px;
color: var(--muted);
user-select:none;
}
.tiny-toggle input{
width: 16px;
height: 16px;
}
.reqmode{
display:none;
margin-top: 8px;
font-size: 12px;
color: #92400e;
font-weight: 700;
}
</style>
</head>
<body>
<div class="topbar">
<div class="topbar-inner">
<div class="brand">
<div class="mark" aria-hidden="true"></div>
<div class="titlewrap">
<div class="title">Concierge Reservation Intake</div>
<div class="subtitle">Dining Reservations Management System</div>
</div>
</div>
<div class="badges">
<span class="badge strong">Production</span>
<span class="badge">v2.4.1</span>
</div>
</div>
</div>
<main>
<section class="panel" aria-label="Reservation form panel">
<div class="panel-header">
<div>
<h2>Reservation Form</h2>
<p>Create a new dining reservation for the guest.</p>
</div>
</div>
<div class="phone-wrap">
<div class="phone" role="application" aria-label="Booking widget mock">
<div class="phone-top">
<div class="back" id="btnBack" title="Back" aria-label="Back">‹</div>
<div class="meta" id="topMeta">Today · 2 guests · 19:00</div>
</div>
<div class="notice ok" id="statusBar">
<div><strong id="statusTitle">Available</strong> <span id="statusMsg">Select details and submit.</span></div>
<span class="pill" id="statusPill">Real-time</span>
</div>
<div class="card">
<div class="section-title">Reservation details</div>
<div class="subcard" style="margin-bottom:12px;">
<div class="row head">Search</div>
<div class="row">
<label for="outlet">Outlet / Restaurant <span aria-hidden="true">*</span></label>
<select id="outlet" data-field="outlet">
<option value="">Select…</option>
<option>Steakhouse</option>
<option>Sushi Bar</option>
<option>Mediterranean</option>
<option>Coastal Grill</option>
<option>Lobby Cafe</option>
</select>
</div>
<div class="row row-grid3">
<div>
<label for="date">Date <span aria-hidden="true">*</span></label>
<input id="date" data-field="date" type="date" />
</div>
<div>
<label for="partySize">Guests <span aria-hidden="true">*</span></label>
<input id="partySize" data-field="partySize" type="number" min="1" max="30" step="1" value="2" />
</div>
<div>
<label for="time">Time <span aria-hidden="true">*</span></label>
<input id="time" data-field="time" type="time" value="19:00" />
</div>
</div>
<div class="row row-grid2">
<div>
<label for="area">Seating area (optional)</label>
<select id="area" data-field="area">
<option value="">No preference</option>
<option>Main Dining Room</option>
<option>Outdoor / Terrace</option>
<option>Bar Seating</option>
<option>Private / Semi-private</option>
</select>
</div>
<div>
<label for="preference">Preference (optional)</label>
<select id="preference" data-field="preference">
<option value="">None</option>
<option>Indoor</option>
<option>Outdoor</option>
<option>Quiet table</option>
<option>Near view</option>
<option>Wheelchair accessible</option>
</select>
</div>
</div>
<div class="row" style="display:flex; justify-content:flex-end; gap:10px; flex-wrap:wrap;">
<button class="small" id="btnSearchTimes" type="button">Select a time slot</button>
<button class="small primary" id="btnCheck" type="button">Check availability</button>
</div>
<div class="row reqmode" id="reqModeHint">
No availability at the selected time. You can submit a request instead.
</div>
</div>
<div class="section-title">Your information</div>
<div class="subcard" style="margin-bottom:12px;">
<div class="row row-grid2">
<div>
<label for="firstName">First Name <span aria-hidden="true">*</span></label>
<input id="firstName" data-field="firstName" type="text" autocomplete="off" />
</div>
<div>
<label for="lastName">Last Name <span aria-hidden="true">*</span></label>
<input id="lastName" data-field="lastName" type="text" autocomplete="off" />
</div>
</div>
<div class="row">
<label for="email">Email Address <span aria-hidden="true">*</span></label>
<input id="email" data-field="email" type="email" autocomplete="off" />
</div>
<div class="row">
<label for="phone">Phone Number <span aria-hidden="true">*</span></label>
<input id="phone" data-field="phone" type="tel" autocomplete="off" placeholder="+1 242 …" />
</div>
</div>
<div class="section-title">Summary</div>
<div class="subcard">
<div class="row">
<div class="inline">
<div style="font-weight:850;">Dietary Restrictions</div>
<button class="addbtn" id="btnAddDiet" type="button">+ Add</button>
</div>
<div class="chips" id="dietChips" aria-label="Dietary restriction chips"></div>
</div>
<div class="row">
<div class="inline">
<div style="font-weight:850;">Special Occasion</div>
<button class="addbtn" id="btnAddOccasion" type="button">+ Add</button>
</div>
<div class="chips" id="occChips" aria-label="Occasion chips"></div>
</div>
<div class="row">
<div class="inline">
<div style="font-weight:850;">Reservation Notes</div>
<button class="addbtn" id="btnAddNotes" type="button">+ Add</button>
</div>
<div id="notesPreview" style="margin-top:8px; color: var(--muted); font-size: 13px;">
None
</div>
</div>
<div class="row">
<label for="internalRef">Internal reference (optional)</label>
<input id="internalRef" data-field="internalRef" type="text" placeholder="Email subject, ticket ID, etc." />
</div>
</div>
</div>
<div class="footer-actions">
<div class="checkrow">
<input id="policy" data-field="policy" type="checkbox" />
<label for="policy" style="margin:0;">
I confirm the guest understands the venue policies (late arrival, cancellations, dress code, etc.).
</label>
</div>
<button class="cta" id="btnSubmit" type="button">Book reservation</button>
</div>
</div>
</div>
</section>
</main>
<!-- Modal backdrop -->
<div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
<div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
<div class="modal-head">
<strong id="modalTitle">Add</strong>
<button class="small ghost" id="modalClose" type="button">Close</button>
</div>
<div class="modal-body">
<div id="modalContent"></div>
</div>
<div class="modal-foot">
<button id="modalCancel" type="button">Cancel</button>
<button class="primary" id="modalSave" type="button">Save</button>
</div>
</div>
</div>
<script>
// ---------------------------
// State + helpers
// ---------------------------
const state = {
outlet: "",
date: "",
partySize: 2,
time: "19:00",
area: "",
preference: "",
firstName: "",
lastName: "",
email: "",
phone: "",
dietaryRestrictions: [],
occasions: [],
notes: "",
internalRef: "",
policy: false,
simulateNoAvail: false,
requestMode: false
};

const $ = (id) => document.getElementById(id);

function todayISO(){
const d = new Date();
const pad = (n) => String(n).padStart(2, "0");
return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
}

function formatTopMeta(){
const d = state.date ? new Date(state.date + "T00:00:00") : new Date();
const day = d.toLocaleDateString(undefined, { weekday: "short" });
const mon = d.toLocaleDateString(undefined, { month: "short" });
const dd = d.toLocaleDateString(undefined, { day: "2-digit" });
const t = state.time || "19:00";
return `${day}, ${dd} ${mon} · ${state.partySize || 2} guests · ${t}`;
}

function setStatus(kind, title, msg){
const bar = $("statusBar");
bar.classList.remove("ok", "warn");
bar.classList.add(kind);
$("statusTitle").textContent = title;
$("statusMsg").textContent = msg;
$("statusPill").textContent = state.requestMode ? "Request mode" : "Real-time";
$("reqModeHint").style.display = state.requestMode ? "block" : "none";
$("btnSubmit").textContent = state.requestMode ? "Submit a request" : "Book reservation";
}

function renderChips(container, arr, onRemove){
container.innerHTML = "";
arr.forEach((val, idx) => {
const chip = document.createElement("span");
chip.className = "chip";
chip.textContent = val;
const x = document.createElement("button");
x.type = "button";
x.setAttribute("aria-label", `Remove ${val}`);
x.textContent = "×";
x.addEventListener("click", () => onRemove(idx));
chip.appendChild(x);
container.appendChild(chip);
});
}

function notesPreview(){
const el = $("notesPreview");
if (!state.notes || !state.notes.trim()){
el.textContent = "None";
el.style.fontStyle = "normal";
return;
}
el.textContent = state.notes.length > 90 ? state.notes.slice(0, 90) + "…" : state.notes;
el.style.fontStyle = "italic";
}

function readStateFromInputs(){
state.outlet = $("outlet").value;
state.date = $("date").value;
state.partySize = Number($("partySize").value || 2);
state.time = $("time").value;
state.area = $("area").value;
state.preference = $("preference").value;
state.firstName = $("firstName").value;
state.lastName = $("lastName").value;
state.email = $("email").value;
state.phone = $("phone").value;
state.internalRef = $("internalRef").value;
state.policy = $("policy").checked;
state.simulateNoAvail = false;
}

function writeInputsFromState(){
$("outlet").value = state.outlet || "";
$("date").value = state.date || todayISO();
$("partySize").value = state.partySize ?? 2;
$("time").value = state.time || "19:00";
$("area").value = state.area || "";
$("preference").value = state.preference || "";
$("firstName").value = state.firstName || "";
$("lastName").value = state.lastName || "";
$("email").value = state.email || "";
$("phone").value = state.phone || "";
$("internalRef").value = state.internalRef || "";
$("policy").checked = !!state.policy;
$("topMeta").textContent = formatTopMeta();
renderChips($("dietChips"), state.dietaryRestrictions, (i) => {
state.dietaryRestrictions.splice(i, 1);
syncAll();
});
renderChips($("occChips"), state.occasions, (i) => {
state.occasions.splice(i, 1);
syncAll();
});
notesPreview();
}

function validateRequired(){
const required = [
["outlet", "Outlet"],
["date", "Date"],
["partySize", "Guests"],
["time", "Time"],
["firstName", "First Name"],
["lastName", "Last Name"],
["email", "Email"],
["phone", "Phone"]
];
const missing = [];
required.forEach(([id, label]) => {
const el = $(id);
const v = (el.type === "checkbox") ? el.checked : (el.value || "").trim();
if (!v) missing.push(label);
});
if (!state.policy) missing.push("Policy acknowledgement");
return missing;
}

function syncAvailability(){
if (state.simulateNoAvail){
state.requestMode = true;
setStatus("warn", "No availability", "You can submit a request for this date/time.");
} else {
state.requestMode = false;
setStatus("ok", "Available", "Ready to book with the details below.");
}
}

function syncAll(){
readStateFromInputs();
$("topMeta").textContent = formatTopMeta();
syncAvailability();
writeInputsFromState();
}


// ---------------------------
// Modal system
// ---------------------------
let modalMode = null;

function openModal(title, contentNode, onSave){
$("modalTitle").textContent = title;
const content = $("modalContent");
content.innerHTML = "";
content.appendChild(contentNode);
$("modalBackdrop").style.display = "flex";
$("modalBackdrop").setAttribute("aria-hidden", "false");
const cleanup = () => {
$("modalBackdrop").style.display = "none";
$("modalBackdrop").setAttribute("aria-hidden", "true");
$("modalSave").onclick = null;
};
$("modalCancel").onclick = cleanup;
$("modalClose").onclick = cleanup;
$("modalBackdrop").onclick = (e) => { if (e.target === $("modalBackdrop")) cleanup(); };
$("modalSave").onclick = () => { onSave?.(); cleanup(); syncAll(); };
}

function makeTextField(label, placeholder, initialValue){
const wrap = document.createElement("div");
const lab = document.createElement("label");
lab.textContent = label;
const inp = document.createElement("input");
inp.type = "text";
inp.placeholder = placeholder || "";
inp.value = initialValue || "";
inp.style.marginTop = "6px";
wrap.appendChild(lab);
wrap.appendChild(inp);
return { wrap, input: inp };
}

// ---------------------------
// Basic parsing (optional)
// ---------------------------
function basicParseEmail(text){
const out = {};
const email = text.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/ig);
if (email && email[0]) out.email = email[0];
const phone = text.match(/(\+\d{1,3}\s?)?(\(?\d{2,4}\)?[\s.-]?)?\d{3}[\s.-]?\d{4}/);
if (phone && phone[0]) out.phone = phone[0];
const party = text.match(/\bparty\s*(of)?\s*(\d{1,2})\b/i) || text.match(/\b(\d{1,2})\s*(guests|people|pax)\b/i);
if (party){
const n = Number(party[2] || party[1]);
if (!Number.isNaN(n)) out.partySize = n;
}
const time = text.match(/\b([01]?\d):([0-5]\d)\s*(am|pm)\b/i) || text.match(/\b([01]?\d|2[0-3]):([0-5]\d)\b/);
if (time){
let hh = Number(time[1]);
const mm = time[2];
const ap = (time[3] || "").toLowerCase();
if (ap === "pm" && hh < 12) hh += 12;
if (ap === "am" && hh === 12) hh = 0;
out.time = String(hh).padStart(2, "0") + ":" + mm;
}
const iso = text.match(/\b(20\d{2})-(\d{2})-(\d{2})\b/);
if (iso) out.date = iso[0];
const nameLine = text.match(/\b(name|guest)\s*:\s*([A-Za-z][A-Za-z.'-]+)\s+([A-Za-z][A-Za-z.'-]+)\b/i);
if (nameLine){
out.firstName = nameLine[2];
out.lastName = nameLine[3];
}
const dietLine = text.match(/\b(allerg(y|ies)|dietary)\s*:\s*(.+)\b/i);
if (dietLine && dietLine[3]){
out.dietaryRestrictions = dietLine[3].split(/[,;]+/).map(s => s.trim()).filter(Boolean);
}
const occLine = text.match(/\b(occasion|celebrating)\s*:\s*(.+)\b/i);
if (occLine && occLine[2]){
out.occasions = occLine[2].split(/[,;]+/).map(s => s.trim()).filter(Boolean);
}
return out;
}

// ---------------------------
// Time slot selector (demo)
// ---------------------------
function openTimeSlotPicker(){
const wrap = document.createElement("div");
const p = document.createElement("p");
p.style.margin = "0 0 10px";
p.style.color = "#4b5563";
p.style.fontSize = "13px";
p.textContent = "Pick a time slot (demo list).";
wrap.appendChild(p);
const grid = document.createElement("div");
grid.style.display = "grid";
grid.style.gridTemplateColumns = "repeat(2, minmax(0, 1fr))";
grid.style.gap = "10px";
const times = ["17:30","17:45","18:00","18:15","18:30","18:45","19:00","19:15","19:30","19:45","20:00"];
times.forEach(t => {
const btn = document.createElement("button");
btn.type = "button";
btn.textContent = t;
btn.style.padding = "12px 10px";
btn.style.borderRadius = "12px";
btn.style.border = "1px solid var(--border)";
btn.style.fontWeight = "850";
btn.addEventListener("click", () => {
state.time = t;
writeInputsFromState();
syncAll();
$("modalCancel").click();
});
grid.appendChild(btn);
});
wrap.appendChild(grid);
openModal("Select a time", wrap, null);
}

// ---------------------------
// Public automation hooks
// ---------------------------
function setReservationData(data){
if (!data || typeof data !== "object") return;
Object.assign(state, data);
state.dietaryRestrictions = Array.isArray(state.dietaryRestrictions) ? state.dietaryRestrictions : [];
state.occasions = Array.isArray(state.occasions) ? state.occasions : [];
state.partySize = Number(state.partySize || 2);
writeInputsFromState();
syncAll();
}

function getReservationData(){
readStateFromInputs();
return {
outlet: state.outlet,
date: state.date,
partySize: state.partySize,
time: state.time,
area: state.area,
preference: state.preference,
firstName: state.firstName,
lastName: state.lastName,
email: state.email,
phone: state.phone,
dietaryRestrictions: [...state.dietaryRestrictions],
occasions: [...state.occasions],
notes: state.notes,
internalRef: state.internalRef,
policy: !!state.policy,
requestMode: !!state.requestMode
};
}

function resetForm(){
Object.assign(state, {
outlet: "",
date: todayISO(),
partySize: 2,
time: "19:00",
area: "",
preference: "",
firstName: "",
lastName: "",
email: "",
phone: "",
dietaryRestrictions: [],
occasions: [],
notes: "",
internalRef: "",
policy: false,
simulateNoAvail: false,
requestMode: false
});
writeInputsFromState();
syncAll();
}

window.setReservationData = setReservationData;
window.getReservationData = getReservationData;
window.resetForm = resetForm;

// ---------------------------
// Wire up events
// ---------------------------
function init(){
$("date").value = todayISO();
writeInputsFromState();
syncAll();

["outlet","date","partySize","time","area","preference","firstName","lastName","email","phone","internalRef","policy"]
.forEach(id => $(id).addEventListener("input", syncAll));

$("btnAddDiet").addEventListener("click", () => {
const { wrap, input } = makeTextField("Dietary restriction", "e.g., Gluten-free, Dairy-free", "");
openModal("Add dietary restriction", wrap, () => {
const v = input.value.trim();
if (v) state.dietaryRestrictions.push(v);
});
});

$("btnAddOccasion").addEventListener("click", () => {
const { wrap, input } = makeTextField("Occasion", "e.g., Birthday, Anniversary", "");
openModal("Add special occasion", wrap, () => {
const v = input.value.trim();
if (v) state.occasions.push(v);
});
});

$("btnAddNotes").addEventListener("click", () => {
const wrap = document.createElement("div");
const lab = document.createElement("label");
lab.textContent = "Reservation notes";
const ta = document.createElement("textarea");
ta.placeholder = "Anything the venue should know (arrival time flexibility, seating request, kids, etc.)";
ta.value = state.notes || "";
ta.style.minHeight = "160px";
ta.style.marginTop = "6px";
wrap.appendChild(lab);
wrap.appendChild(ta);
openModal("Edit notes", wrap, () => { state.notes = ta.value.trim(); });
});

$("btnCheck").addEventListener("click", () => { syncAll(); });
$("btnSearchTimes").addEventListener("click", openTimeSlotPicker);

$("btnSubmit").addEventListener("click", () => {
const missing = validateRequired();
if (missing.length){
setStatus("warn", "Missing info", "Please fill: " + missing.join(", ") + ".");
return;
}
if (state.requestMode){
setStatus("ok", "Request submitted", "Demo only. Your integration can POST this payload.");
} else {
setStatus("ok", "Booked", "Demo only. Your integration can trigger booking here.");
}
});

$("btnBack").addEventListener("click", () => {
setStatus(state.requestMode ? "warn" : "ok",
state.requestMode ? "No availability" : "Available",
state.requestMode ? "You can submit a request for this date/time." : "Select details and submit."
);
});
}

init();
</script>
</body>
</html>